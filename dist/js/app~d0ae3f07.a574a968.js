(function(t){function e(e){for(var a,r,i=e[0],c=e[1],l=e[2],u=0,d=[];u<i.length;u++)r=i[u],s[r]&&d.push(s[r][0]),s[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);f&&f(e);while(d.length)d.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],a=!0,r=1;r<n.length;r++){var i=n[r];0!==s[i]&&(a=!1)}a&&(o.splice(e--,1),t=c(c.s=n[0]))}return t}var a={},r={"app~d0ae3f07":0},s={"app~d0ae3f07":0},o=[];function i(t){return c.p+"js/"+({}[t]||t)+"."+{"chunk-744c9ad6":"c57aa27a","chunk-772e958e":"6155efac"}[t]+".js"}function c(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(t){var e=[],n={"chunk-744c9ad6":1,"chunk-772e958e":1};r[t]?e.push(r[t]):0!==r[t]&&n[t]&&e.push(r[t]=new Promise(function(e,n){for(var a="css/"+({}[t]||t)+"."+{"chunk-744c9ad6":"68141692","chunk-772e958e":"cd2c3c01"}[t]+".css",r=c.p+a,s=document.getElementsByTagName("link"),o=0;o<s.length;o++){var i=s[o],l=i.getAttribute("data-href")||i.getAttribute("href");if("stylesheet"===i.rel&&(l===a||l===r))return e()}var u=document.getElementsByTagName("style");for(o=0;o<u.length;o++){i=u[o],l=i.getAttribute("data-href");if(l===a||l===r)return e()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=e,d.onerror=function(e){var a=e&&e.target&&e.target.src||r,s=new Error("Loading CSS chunk "+t+" failed.\n("+a+")");s.request=a,n(s)},d.href=r;var f=document.getElementsByTagName("head")[0];f.appendChild(d)}).then(function(){r[t]=0}));var a=s[t];if(0!==a)if(a)e.push(a[2]);else{var o=new Promise(function(e,n){a=s[t]=[e,n]});e.push(a[2]=o);var l,u=document.getElementsByTagName("head")[0],d=document.createElement("script");d.charset="utf-8",d.timeout=120,c.nc&&d.setAttribute("nonce",c.nc),d.src=i(t),l=function(e){d.onerror=d.onload=null,clearTimeout(f);var n=s[t];if(0!==n){if(n){var a=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src,o=new Error("Loading chunk "+t+" failed.\n("+a+": "+r+")");o.type=a,o.request=r,n[1](o)}s[t]=void 0}};var f=setTimeout(function(){l({type:"timeout",target:d})},12e4);d.onerror=d.onload=l,u.appendChild(d)}return Promise.all(e)},c.m=t,c.c=a,c.d=function(t,e,n){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)c.d(n,a,function(e){return t[e]}.bind(null,a));return n},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="",c.oe=function(t){throw console.error(t),t};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],u=l.push.bind(l);l.push=e,l=l.slice();for(var d=0;d<l.length;d++)e(l[d]);var f=u;o.push([0,"chunk-vendors~7274e1de","chunk-vendors~ec8c427e","chunk-vendors~fdc6512a","chunk-vendors~0605657e","chunk-vendors~d2305125","chunk-vendors~78eefc6e","chunk-vendors~4a7e9e0b"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var a=n("771e"),r=n.n(a);r.a},"0766":function(t,e,n){"use strict";var a=n("fb6b"),r=n.n(a);r.a},"4ec4":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-toolbar",{attrs:{color:t.color,dense:"",flat:"",app:""}},[n("v-toolbar-title",[t._t("left")],2),n("v-spacer"),t._t("right")],2)},r=[],s={props:["color"]},o=s,i=(n("f7cd"),n("2877")),c=n("6544"),l=n.n(c),u=n("9910"),d=n("71d9"),f=n("2a7f"),h=Object(i["a"])(o,a,r,!1,null,null,null);h.options.__file="Titlebar.vue";e["a"]=h.exports;l()(h,{VSpacer:u["a"],VToolbar:d["a"],VToolbarTitle:f["a"]})},"56d7":function(t,e,n){"use strict";n.r(e);var a=n("2b0e"),r=n("bb71");n.e("chunk-772e958e").then(n.t.bind(null,"da64",7)),n.e("chunk-744c9ad6").then(n.t.bind(null,"15f5",7)),a["a"].use(r["a"],{iconfont:["md","fa"]});var s=n("8c4f"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-layout",{staticStyle:{background:"#ff4800"},attrs:{"justify-center":"","align-center":"","fill-height":""}},[n("div",[n("v-layout",{attrs:{column:"","align-center":""}},[n("v-img",{attrs:{src:"/logo.svg",width:"350",height:"64"}}),n("v-img",{staticClass:"mt-4",attrs:{width:"350",height:"260",src:"/dudes.svg"}}),n("v-layout",{staticClass:"mt-2",staticStyle:{width:"100%"}},[n("v-text-field",{attrs:{color:"white",label:"What Room?",dark:"","hide-details":""},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.joinRoom(e):null}},model:{value:t.room,callback:function(e){t.room=e},expression:"room"}}),n("v-btn",{staticClass:"mb-0 mr-0",attrs:{large:"",icon:"",dark:""},on:{click:t.joinRoom}},[n("v-icon",{attrs:{large:""}},[t._v("meeting_room")])],1)],1)],1)],1)])},i=[],c={data(){return{room:null}},methods:{joinRoom(){this.$router.push(this.room),this.room=null}},mounted(){new window.QRCode(document.getElementById("qrcode"),{text:"test",width:128,height:128,colorDark:"#fff",colorLight:"transparent",correctLevel:window.QRCode.CorrectLevel.H})}},l=c,u=n("2877"),d=n("6544"),f=n.n(d),h=n("8336"),p=n("132d"),m=n("adda"),v=n("a722"),g=n("2677"),b=Object(u["a"])(l,o,i,!1,null,null,null);b.options.__file="Home.vue";var y=b.exports;f()(b,{VBtn:h["a"],VIcon:p["a"],VImg:m["a"],VLayout:v["a"],VTextField:g["a"]});var k=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-layout",{staticClass:"chatNgen grey lighten-2",attrs:{"fill-height":"",column:""}},[n("v-tabs",{staticClass:"tabs grey darken-1",attrs:{dark:""}},[n("v-tab",[t._v("Chat")]),n("v-tab",[t._v("Peers ("+t._s(t.peers.length)+")")]),n("v-tab-item",[n("v-card",{attrs:{flat:""}},[n("v-layout",{attrs:{"fill-height":"",column:""}},[n("v-layout",{staticClass:"chatBox",attrs:{column:""}},[n("v-spacer"),t._l(t.messages,function(e,a){return n("div",{key:"msg-"+a+"-"+t.lastUpdate},[n("div",[e.nickname?n("span",{staticClass:"font-weight-bold"},[t._v("\n                  "+t._s(e.nickname)+"\n                ")]):t._e(),n("span",{staticClass:"mono"},[t._v(t._s(e.peerId))]),n("span",{staticClass:"caption"},[t._v(" ("+t._s(t.timeAgo(e.ts))+")")])]),n("div",[t._v(t._s(e.msg))]),a<t.messages.length?n("v-divider"):t._e()],1)})],2),n("v-divider"),n("div",[n("v-layout",[n("v-text-field",{attrs:{placeholder:"Message",solo:"",flat:"","hide-details":""},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.send(e):null}},model:{value:t.msg,callback:function(e){t.msg=e},expression:"msg"}}),n("v-btn",{attrs:{icon:""},on:{click:t.send}},[n("v-icon",{attrs:{color:"text--grey"}},[t._v("chat")])],1)],1)],1)],1)],1)],1),n("v-tab-item",[n("v-card",{attrs:{flat:""}},[n("v-list",{staticClass:"pt-0"},[n("v-list-tile",{staticClass:"mt-0 grey darken-1 white--text"},[n("span",{staticClass:"font-weight-bold"},[t._v("#"+t._s(t.$route.params.room))])]),t._l(t.peers,function(e,a){return[n("v-list-tile",{key:"peer-"+a},[n("span",{staticClass:"font-weight-bold"},[t._v(t._s(e.nickname))]),n("span",[t._v(" ("+t._s(e.peerId)+")")])]),n("v-divider",{key:"div-"+a})]})],2)],1)],1)],1)],1)},w=[],_=n("ed6e"),x=n("b356"),C=n.n(x),V={name:"ChatNgen",components:{},data(){return{msg:null,messages:[],peers:[],lastUpdate:Date.now()}},methods:{send(){_["a"].$emit("send",this.msg),this.msg=null},timeAgo(t){return C()().format(t)},registerPeer(t){const e=this.peers.filter(e=>e.peerId===t.peerId).length;e||this.peers.push(t)},updatePeer(t){for(let e=0;e<this.peers.length;e++)this.peers[e].peerId===t&&(this.peers[e].ts=Date.now())},clearInactivePeers(){const t=Date.now()-3e4;this.peers=this.peers.filter(e=>e.ts>=t)}},mounted(){_["a"].$on("incoming",t=>{const e=Date.now();try{const{peerId:a,nickname:r,msg:s}=JSON.parse(t);this.registerPeer({peerId:a,nickname:r,ts:e}),this.updatePeer(a),s&&this.messages.push({ts:e,peerId:a,nickname:r,msg:s})}catch(n){console.error(n)}this.lastUpdate=e}),window.setInterval(()=>{this.lastUpdate=Date.now(),this.clearInactivePeers()},15e3)}},I=V,O=(n("0766"),n("b0af")),j=n("ce7e"),E=n("8860"),T=n("ba95"),S=n("9910"),P=n("71a3"),$=n("c671"),N=n("fe57"),B=Object(u["a"])(I,k,w,!1,null,"c507ac5a",null);B.options.__file="ChatNgen.vue";var L=B.exports;f()(B,{VBtn:h["a"],VCard:O["a"],VDivider:j["a"],VIcon:p["a"],VLayout:v["a"],VList:E["a"],VListTile:T["a"],VSpacer:S["a"],VTab:P["a"],VTabItem:$["a"],VTabs:N["a"],VTextField:g["a"]}),a["a"].use(s["a"]);var A=new s["a"]({routes:[{path:"/",name:"chatngen",component:y},{path:"/:room",name:"chatngen",component:L}]}),D=n("2f62"),R=n("0e44");a["a"].use(D["a"]);const J={merge(t,e){Object.keys(e).forEach(n=>e[n].constructor===String?t[n]=e[n]:Object.keys(e[n]).forEach(a=>t[n][a]=e[n][a]))}},M=new D["a"].Store({state:{},mutations:J,plugins:[Object(R["a"])({key:"vim-network-digital-asset-template",paths:[]})]});var U=M,F=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[t.$route.params.room?n("titlebar",[n("div",{staticClass:"titleLeft headline text-uppercase",attrs:{slot:"left"},slot:"left"},[t.$vuetify.breakpoint.smAndUp?n("v-flex",[n("router-link",{attrs:{to:"/"}},[n("span",[t._v("chat")]),n("span",{staticClass:"font-weight-light"},[t._v("NGEN")])])],1):n("v-flex",[n("v-img",{attrs:{src:"/favicon.svg",width:"32",height:"32"}})],1)],1),n("div",{staticClass:"titleRight",attrs:{slot:"right"},slot:"right"},[n("v-flex",{staticClass:"peerId"},[n("v-text-field",{attrs:{placeholder:t.identity.peerId,"prepend-icon":"alternate_email",solo:"",flat:"","hide-details":""},model:{value:t.identity.nickname,callback:function(e){t.$set(t.identity,"nickname",e)},expression:"identity.nickname"}})],1)],1)]):n("titlebar",{attrs:{color:"#ea4200"}},[n("div",{attrs:{slot:"right"},slot:"right"},[n("v-btn",{staticClass:"downloadLink transparent text--white",attrs:{href:"https://github.com/rtbz/chatngen/raw/master/extension/browser-extensions.zip",flat:"",dark:""}},[t._v("Download Extension")])],1)]),n("v-content",[n("router-view")],1)],1)},q=[],z=n("cb9b"),H=z["a"],Q=(n("034f"),n("c247"),n("7496")),G=n("549c"),W=n("0e8f"),X=Object(u["a"])(H,F,q,!1,null,"09383281",null);X.options.__file="App.vue";var K=X.exports;f()(X,{VApp:Q["a"],VBtn:h["a"],VContent:G["a"],VFlex:W["a"],VImg:m["a"],VTextField:g["a"]}),a["a"].config.productionTip=!1,new a["a"]({render:t=>t(K),router:A,store:U}).$mount("#app")},6285:function(t,e){t.exports={config:{Addresses:{Swarm:["/dns4/ws-star.discovery.libp2p.io/tcp/443/wss/p2p-websocket-star"]}},EXPERIMENTAL:{pubsub:!0}}},"771e":function(t,e,n){},b263:function(t,e,n){},bf31:function(t,e,n){},c247:function(t,e,n){"use strict";var a=n("bf31"),r=n.n(a);r.a},cb9b:function(t,e,n){"use strict";(function(t){var a=n("6285"),r=n.n(a),s=n("cfb0"),o=n("4ec4"),i=n("ed6e");e["a"]={components:{Titlebar:o["a"]},data(){return{node:null,room:null,identity:{peerId:null,nickname:null}}},methods:{incoming(t){const{from:e,data:n}=t;try{const{nickname:t,msg:r}=JSON.parse(n.toString());i["a"].$emit("incoming",JSON.stringify({peerId:e,nickname:t,msg:r}))}catch(a){console.error(a)}},publish(e){this.node.pubsub.publish(this.room,t.from(JSON.stringify({nickname:this.identity.nickname,msg:e})),t=>{t&&console.error(t)})},heartBeat(){this.publish(null)}},mounted:async function(){this.room=this.$route.params.room;const{node:t,identity:e}=await Object(s["a"])(r.a);this.node=t,this.identity.peerId=e.id,this.node.pubsub.subscribe(this.room,t=>{this.incoming(t)}),i["a"].$on("send",t=>this.publish(t)),window.setInterval(()=>this.heartBeat(),1e4)}}}).call(this,n("b639").Buffer)},cfb0:function(t,e,n){"use strict";n.d(e,"a",function(){return a});const a=t=>new Promise((e,n)=>{const a=new window.Ipfs(t);a.on("ready",()=>{a.id((t,r)=>{if(t)return n(t);e({node:a,identity:r})})})})},ed6e:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var a=n("2b0e");const r=new a["a"]},f7cd:function(t,e,n){"use strict";var a=n("b263"),r=n.n(a);r.a},fb6b:function(t,e,n){}});
//# sourceMappingURL=app~d0ae3f07.a574a968.js.map