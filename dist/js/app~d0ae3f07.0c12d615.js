(function(e){function t(t){for(var a,r,i=t[0],c=t[1],l=t[2],u=0,d=[];u<i.length;u++)r=i[u],s[r]&&d.push(s[r][0]),s[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);f&&f(t);while(d.length)d.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,r=1;r<n.length;r++){var i=n[r];0!==s[i]&&(a=!1)}a&&(o.splice(t--,1),e=c(c.s=n[0]))}return e}var a={},r={"app~d0ae3f07":0},s={"app~d0ae3f07":0},o=[];function i(e){return c.p+"js/"+({}[e]||e)+"."+{"chunk-744c9ad6":"c57aa27a","chunk-772e958e":"6155efac"}[e]+".js"}function c(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(e){var t=[],n={"chunk-744c9ad6":1,"chunk-772e958e":1};r[e]?t.push(r[e]):0!==r[e]&&n[e]&&t.push(r[e]=new Promise(function(t,n){for(var a="css/"+({}[e]||e)+"."+{"chunk-744c9ad6":"68141692","chunk-772e958e":"cd2c3c01"}[e]+".css",r=c.p+a,s=document.getElementsByTagName("link"),o=0;o<s.length;o++){var i=s[o],l=i.getAttribute("data-href")||i.getAttribute("href");if("stylesheet"===i.rel&&(l===a||l===r))return t()}var u=document.getElementsByTagName("style");for(o=0;o<u.length;o++){i=u[o],l=i.getAttribute("data-href");if(l===a||l===r)return t()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=t,d.onerror=function(t){var a=t&&t.target&&t.target.src||r,s=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");s.request=a,n(s)},d.href=r;var f=document.getElementsByTagName("head")[0];f.appendChild(d)}).then(function(){r[e]=0}));var a=s[e];if(0!==a)if(a)t.push(a[2]);else{var o=new Promise(function(t,n){a=s[e]=[t,n]});t.push(a[2]=o);var l,u=document.getElementsByTagName("head")[0],d=document.createElement("script");d.charset="utf-8",d.timeout=120,c.nc&&d.setAttribute("nonce",c.nc),d.src=i(e),l=function(t){d.onerror=d.onload=null,clearTimeout(f);var n=s[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src,o=new Error("Loading chunk "+e+" failed.\n("+a+": "+r+")");o.type=a,o.request=r,n[1](o)}s[e]=void 0}};var f=setTimeout(function(){l({type:"timeout",target:d})},12e4);d.onerror=d.onload=l,u.appendChild(d)}return Promise.all(t)},c.m=e,c.c=a,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)c.d(n,a,function(t){return e[t]}.bind(null,a));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="",c.oe=function(e){throw console.error(e),e};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],u=l.push.bind(l);l.push=t,l=l.slice();for(var d=0;d<l.length;d++)t(l[d]);var f=u;o.push([0,"chunk-vendors~7274e1de","chunk-vendors~ec8c427e","chunk-vendors~fdc6512a","chunk-vendors~0605657e","chunk-vendors~d2305125","chunk-vendors~78eefc6e","chunk-vendors~4a7e9e0b"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var a=n("771e"),r=n.n(a);r.a},"0766":function(e,t,n){"use strict";var a=n("fb6b"),r=n.n(a);r.a},"4ec4":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-toolbar",{attrs:{color:e.color,dense:"",flat:"",app:""}},[n("v-toolbar-title",[e._t("left")],2),n("v-spacer"),e._t("right")],2)},r=[],s={props:["color"]},o=s,i=(n("f7cd"),n("2877")),c=n("6544"),l=n.n(c),u=n("9910"),d=n("71d9"),f=n("2a7f"),h=Object(i["a"])(o,a,r,!1,null,null,null);h.options.__file="Titlebar.vue";t["a"]=h.exports;l()(h,{VSpacer:u["a"],VToolbar:d["a"],VToolbarTitle:f["a"]})},"56d7":function(e,t,n){"use strict";n.r(t);var a=n("2b0e"),r=n("bb71");n.e("chunk-772e958e").then(n.t.bind(null,"da64",7)),n.e("chunk-744c9ad6").then(n.t.bind(null,"15f5",7)),a["a"].use(r["a"],{iconfont:["md","fa"]});var s=n("8c4f"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-layout",{staticStyle:{background:"#ff4800"},attrs:{"justify-center":"","align-center":"","fill-height":""}},[n("div",[n("v-layout",{attrs:{column:"","align-center":""}},[n("v-img",{attrs:{src:"/logo.svg",width:"350",height:"64"}}),n("v-img",{staticClass:"mt-4",attrs:{width:"350",height:"260",src:"/dudes.svg"}}),n("v-layout",{staticClass:"mt-2",staticStyle:{width:"100%"}},[n("v-text-field",{attrs:{color:"white",label:"What Room?",dark:"","hide-details":""},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.joinRoom(t):null}},model:{value:e.room,callback:function(t){e.room=t},expression:"room"}}),n("v-btn",{staticClass:"mb-0 mr-0",attrs:{large:"",icon:"",dark:""},on:{click:e.joinRoom}},[n("v-icon",{attrs:{large:""}},[e._v("meeting_room")])],1)],1)],1)],1)])},i=[],c={data(){return{room:null}},methods:{joinRoom(){this.$router.push(this.room),this.room=null}},mounted(){new window.QRCode(document.getElementById("qrcode"),{text:"test",width:128,height:128,colorDark:"#fff",colorLight:"transparent",correctLevel:window.QRCode.CorrectLevel.H})}},l=c,u=n("2877"),d=n("6544"),f=n.n(d),h=n("8336"),p=n("132d"),m=n("adda"),v=n("a722"),g=n("2677"),b=Object(u["a"])(l,o,i,!1,null,null,null);b.options.__file="Home.vue";var y=b.exports;f()(b,{VBtn:h["a"],VIcon:p["a"],VImg:m["a"],VLayout:v["a"],VTextField:g["a"]});var k=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-layout",{staticClass:"chatNgen grey lighten-2",attrs:{"fill-height":"",column:""}},[n("v-tabs",{staticClass:"tabs grey darken-1",attrs:{dark:""}},[n("v-tab",[e._v("Chat")]),n("v-tab",[e._v("Peers ("+e._s(e.peers.length)+")")]),n("v-tab-item",[n("v-card",{attrs:{flat:""}},[n("v-layout",{attrs:{"fill-height":"",column:""}},[n("v-layout",{staticClass:"chatBox",attrs:{column:""}},[n("v-spacer"),e._l(e.messages,function(t,a){return n("div",{key:"msg-"+a+"-"+e.lastUpdate},[n("div",[t.nickname?n("span",{staticClass:"font-weight-bold"},[e._v("\n                  "+e._s(t.nickname)+"\n                ")]):e._e(),n("span",{staticClass:"mono"},[e._v(e._s(t.peerId))]),n("span",{staticClass:"caption"},[e._v(" ("+e._s(e.timeAgo(t.ts))+")")])]),n("div",[e._v(e._s(t.msg))]),a<e.messages.length?n("v-divider"):e._e()],1)})],2),n("v-divider"),n("div",[n("v-layout",[n("v-text-field",{attrs:{placeholder:"Message",solo:"",flat:"","hide-details":""},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.send(t):null}},model:{value:e.msg,callback:function(t){e.msg=t},expression:"msg"}}),n("v-btn",{attrs:{icon:""},on:{click:e.send}},[n("v-icon",{attrs:{color:"text--grey"}},[e._v("chat")])],1)],1)],1)],1)],1)],1),n("v-tab-item",[n("v-card",{attrs:{flat:""}},[n("v-list",{staticClass:"pt-0"},[n("v-list-tile",{staticClass:"mt-0 grey darken-1 white--text"},[n("span",{staticClass:"font-weight-bold"},[e._v("#"+e._s(e.$route.params.room))])]),e._l(e.peers,function(t,a){return[n("v-list-tile",{key:"peer-"+a},[n("span",{staticClass:"font-weight-bold"},[e._v(e._s(t.nickname))]),n("span",[e._v(" ("+e._s(t.peerId)+")")])]),n("v-divider",{key:"div-"+a})]})],2)],1)],1)],1)],1)},w=[],_=n("ed6e"),x=n("b356"),C=n.n(x),V={name:"ChatNgen",components:{},data(){return{msg:null,messages:[],peers:[],lastUpdate:Date.now()}},methods:{send(){_["a"].$emit("send",this.msg),this.msg=null},timeAgo(e){return C()().format(e)},registerPeer(e){const t=this.peers.filter(t=>t.peerId===e.peerId).length;t||this.peers.push(e)},updatePeer(e){for(let t=0;t<this.peers.length;t++)this.peers[t].peerId===e&&(this.peers[t].ts=Date.now())},clearInactivePeers(){const e=Date.now()-3e4;this.peers=this.peers.filter(t=>t.ts>=e)}},mounted(){_["a"].$on("incoming",e=>{const t=Date.now();try{const{peerId:a,nickname:r,msg:s}=JSON.parse(e);this.registerPeer({peerId:a,nickname:r,ts:t}),this.updatePeer(a),s&&this.messages.push({ts:t,peerId:a,nickname:r,msg:s})}catch(n){console.error(n)}this.lastUpdate=t}),window.setInterval(()=>{this.lastUpdate=Date.now(),this.clearInactivePeers()},15e3)}},I=V,O=(n("0766"),n("b0af")),j=n("ce7e"),E=n("8860"),T=n("ba95"),S=n("9910"),P=n("71a3"),$=n("c671"),N=n("fe57"),B=Object(u["a"])(I,k,w,!1,null,"c507ac5a",null);B.options.__file="ChatNgen.vue";var L=B.exports;f()(B,{VBtn:h["a"],VCard:O["a"],VDivider:j["a"],VIcon:p["a"],VLayout:v["a"],VList:E["a"],VListTile:T["a"],VSpacer:S["a"],VTab:P["a"],VTabItem:$["a"],VTabs:N["a"],VTextField:g["a"]}),a["a"].use(s["a"]);var A=new s["a"]({routes:[{path:"/",name:"chatngen",component:y},{path:"/:room",name:"chatngen",component:L}]}),D=n("2f62"),R=n("0e44");a["a"].use(D["a"]);const J={merge(e,t){Object.keys(t).forEach(n=>t[n].constructor===String?e[n]=t[n]:Object.keys(t[n]).forEach(a=>e[n][a]=t[n][a]))}},M=new D["a"].Store({state:{},mutations:J,plugins:[Object(R["a"])({key:"vim-network-digital-asset-template",paths:[]})]});var U=M,F=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",[e.$route.params.room?n("titlebar",[n("div",{staticClass:"titleLeft headline text-uppercase",attrs:{slot:"left"},slot:"left"},[e.$vuetify.breakpoint.smAndUp?n("v-flex",[n("router-link",{attrs:{to:"/"}},[n("span",[e._v("chat")]),n("span",{staticClass:"font-weight-light"},[e._v("NGEN")])])],1):n("v-flex",[n("v-img",{attrs:{src:"/favicon.svg",width:"32",height:"32"}})],1)],1),n("div",{staticClass:"titleRight",attrs:{slot:"right"},slot:"right"},[n("v-flex",{staticClass:"peerId"},[n("v-text-field",{attrs:{placeholder:e.identity.peerId,"prepend-icon":"alternate_email",solo:"",flat:"","hide-details":""},model:{value:e.identity.nickname,callback:function(t){e.$set(e.identity,"nickname",t)},expression:"identity.nickname"}})],1)],1)]):n("titlebar",{attrs:{color:"#ea4200"}},[n("div",{attrs:{slot:"right"},slot:"right"},[n("v-btn",{staticClass:"downloadLink transparent text--white",attrs:{href:"https://github.com/rtbz/chatngen/raw/master/extension/browser-extensions.zip",flat:"",dark:""}},[e._v("Download Extension")])],1)]),n("v-content",[n("router-view")],1)],1)},q=[],z=n("cb9b"),H=z["a"],Q=(n("034f"),n("e7a5"),n("7496")),G=n("549c"),W=n("0e8f"),X=Object(u["a"])(H,F,q,!1,null,"374a1c00",null);X.options.__file="App.vue";var K=X.exports;f()(X,{VApp:Q["a"],VBtn:h["a"],VContent:G["a"],VFlex:W["a"],VImg:m["a"],VTextField:g["a"]}),a["a"].config.productionTip=!1,new a["a"]({render:e=>e(K),router:A,store:U}).$mount("#app")},6285:function(e,t){e.exports={config:{Addresses:{Swarm:["/dns4/ws-star.discovery.libp2p.io/tcp/443/wss/p2p-websocket-star"]}},EXPERIMENTAL:{pubsub:!0}}},"771e":function(e,t,n){},b263:function(e,t,n){},cb9b:function(e,t,n){"use strict";(function(e){var a=n("6285"),r=n.n(a),s=n("cfb0"),o=n("4ec4"),i=n("ed6e");t["a"]={components:{Titlebar:o["a"]},data(){return{node:null,room:null,identity:{peerId:null,nickname:null}}},methods:{incoming(e){const{from:t,data:n}=e;try{const{nickname:e,msg:r}=JSON.parse(n.toString());i["a"].$emit("incoming",JSON.stringify({peerId:t,nickname:e,msg:r}))}catch(a){console.error(a)}},publish(t){this.node.pubsub.publish(this.room,e.from(JSON.stringify({nickname:this.identity.nickname,msg:t})),e=>{e&&console.error(e)})},heartBeat(){this.publish(null)}},mounted:async function(){this.room=this.$route.params.room;const{node:e,identity:t}=await Object(s["a"])(r.a);this.node=e,this.identity.peerId=t.id,this.node.pubsub.subscribe(this.room,e=>{this.incoming(e)}),i["a"].$on("send",e=>this.publish(e)),window.setInterval(()=>this.heartBeat,1e4)}}}).call(this,n("b639").Buffer)},cfb0:function(e,t,n){"use strict";n.d(t,"a",function(){return a});const a=e=>new Promise((t,n)=>{const a=new window.Ipfs(e);a.on("ready",()=>{a.id((e,r)=>{if(e)return n(e);t({node:a,identity:r})})})})},e7a5:function(e,t,n){"use strict";var a=n("ecf9"),r=n.n(a);r.a},ecf9:function(e,t,n){},ed6e:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n("2b0e");const r=new a["a"]},f7cd:function(e,t,n){"use strict";var a=n("b263"),r=n.n(a);r.a},fb6b:function(e,t,n){}});
//# sourceMappingURL=app~d0ae3f07.0c12d615.js.map